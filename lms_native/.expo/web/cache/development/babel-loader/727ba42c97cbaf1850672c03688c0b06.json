{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/opt/lampp/htdocs/codi/LMS/lms_native/Take_Attendance.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { DataTable } from 'react-native-paper';\nimport API from \"./api\";\nimport Classroom from \"./components/Classroom\";\nimport Section from \"./components/Section\";\nexport default function Take_Attendance() {\n  var _this = this;\n\n  var _useState = useState({\n    students: [],\n    classroom_id: \"\",\n    section_id: \"\",\n    attendance: {},\n    showSubmit: false\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      updateState = _useState2[1];\n\n  var today = new Date();\n  var year = today.getFullYear();\n  var month = today.getMonth() + 1;\n  var day = today.getDate();\n  if (month < 10) month = \"0\" + month;\n  if (day < 10) day = \"0\" + day;\n  var date = year + '-' + month + '-' + day;\n  var filter = {\n    section_id: state.section_id,\n    classroom_id: state.classroom_id\n  };\n\n  var fetchdata = function fetchdata() {\n    return _regeneratorRuntime.async(function fetchdata$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setState({\n              attendance: {}\n            });\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(API.post(\"stu-sec-class\").then(function (res) {\n              var result = res.data.data;\n              var data = result.filter(function (s) {\n                return s.section_id == state.section_id;\n              });\n\n              if (data) {\n                data.map(function (s) {\n                  var attendance = state.attendance;\n                  attendance[s.id] = \"Present\";\n                  setState({\n                    attendance: attendance\n                  });\n                });\n              }\n\n              setState({\n                students: data\n              });\n            }));\n\n          case 3:\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(API.get(\"attendance\").then(function (res) {\n              var result = res.data.data;\n              var update = result.filter(function (a) {\n                return a.created_at.slice(0, 10) == date && a.section_id == state.section_id;\n              });\n\n              if (update && update.length) {\n                update.map(function (s) {\n                  var attendance = state.attendance;\n                  attendance[s.student_id] = s.description;\n                  setState({\n                    attendance: attendance\n                  });\n                });\n              }\n            }));\n\n          case 5:\n            if (state.classroom_id == \"\") setState({\n              section_id: \"\"\n            });\n            checkSubmit();\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var checkSubmit = function checkSubmit() {\n    state.section_id != \"\" ? setState({\n      showSubmit: true\n    }) : setState({\n      showSubmit: false\n    });\n  };\n\n  var setState = function setState(nextState) {\n    updateState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), nextState);\n    });\n  };\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setState(_defineProperty({}, name, value));\n  };\n\n  var changeDescription = function changeDescription(key, val) {\n    var attendance = state.attendance;\n    attendance[key] = val;\n    setState({\n      attendance: attendance\n    });\n  };\n\n  var submitAttendance = function submitAttendance() {\n    var updateFunction, createFunction;\n    return _regeneratorRuntime.async(function submitAttendance$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            updateFunction = function updateFunction(update) {\n              var _loop, i;\n\n              return _regeneratorRuntime.async(function updateFunction$(_context3) {\n                while (1) {\n                  switch (_context3.prev = _context3.next) {\n                    case 0:\n                      _loop = function _loop(i) {\n                        var student, key, reqBody, att, id;\n                        return _regeneratorRuntime.async(function _loop$(_context2) {\n                          while (1) {\n                            switch (_context2.prev = _context2.next) {\n                              case 0:\n                                student = state.students[i];\n                                key = student.id;\n                                reqBody = {\n                                  description: state.attendance[key],\n                                  section_id: state.section_id,\n                                  student_id: key\n                                };\n                                att = update.find(function (a) {\n                                  return a.student_id == key;\n                                });\n                                id = att.id;\n                                _context2.next = 7;\n                                return _regeneratorRuntime.awrap(API.put(\"attendance/\" + id, reqBody));\n\n                              case 7:\n                              case \"end\":\n                                return _context2.stop();\n                            }\n                          }\n                        }, null, null, null, Promise);\n                      };\n\n                      i = 0;\n\n                    case 2:\n                      if (!(i < state.students.length)) {\n                        _context3.next = 8;\n                        break;\n                      }\n\n                      _context3.next = 5;\n                      return _regeneratorRuntime.awrap(_loop(i));\n\n                    case 5:\n                      i++;\n                      _context3.next = 2;\n                      break;\n\n                    case 8:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            };\n\n            createFunction = function createFunction() {\n              return _regeneratorRuntime.async(function createFunction$(_context5) {\n                while (1) {\n                  switch (_context5.prev = _context5.next) {\n                    case 0:\n                      state.students.map(function _callee(student) {\n                        var key, reqBody;\n                        return _regeneratorRuntime.async(function _callee$(_context4) {\n                          while (1) {\n                            switch (_context4.prev = _context4.next) {\n                              case 0:\n                                key = student.id;\n                                reqBody = {\n                                  description: state.attendance[key],\n                                  section_id: state.section_id,\n                                  student_id: key\n                                };\n                                _context4.next = 4;\n                                return _regeneratorRuntime.awrap(API.post(\"attendance\", reqBody));\n\n                              case 4:\n                              case \"end\":\n                                return _context4.stop();\n                            }\n                          }\n                        }, null, null, null, Promise);\n                      });\n\n                    case 1:\n                    case \"end\":\n                      return _context5.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            };\n\n            _context6.next = 4;\n            return _regeneratorRuntime.awrap(API.get(\"attendance\").then(function (res) {\n              var result = res.data.data;\n              var update = result.filter(function (a) {\n                return a.created_at.slice(0, 10) == date && a.section_id == state.section_id;\n              });\n\n              if (update && update.length) {\n                updateFunction(update);\n              } else {\n                createFunction();\n              }\n            }));\n\n          case 4:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    fetchdata();\n  }, [JSON.stringify(filter)]);\n  return React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 13\n    }\n  }), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    className: \"helloclass\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, React.createElement(Classroom, {\n    id: state.classroom_id,\n    name: \"classroom_id\",\n    onValueChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }), React.createElement(Section, {\n    id: state.classroom_id,\n    onValueChange: handleChange,\n    selectedValue: state.section_id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 21\n    }\n  })), React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return alert('Hello, world!');\n    },\n    style: {\n      backgroundColor: 'blue'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 17\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontSize: 20,\n      color: '#fff'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, \"Pick a photo\")), React.createElement(\"input\", {\n    type: \"button\",\n    value: \"Submit\",\n    onClick: submitAttendance,\n    style: {\n      display: state.showSubmit ? 'block' : 'none'\n    },\n    className: \"filterClass absolutsubmitbutton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 17\n    }\n  })), React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, React.createElement(DataTable, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }\n  }, React.createElement(DataTable.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 21\n    }\n  }, React.createElement(DataTable.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 25\n    }\n  }, \"ID\"), React.createElement(DataTable.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 25\n    }\n  }, \"Name\"), React.createElement(DataTable.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 25\n    }\n  }, \"Class\"), React.createElement(DataTable.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 25\n    }\n  }, \"Attendance\")), state.students.map(function (student) {\n    return React.createElement(DataTable.Row, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 25\n      }\n    }, React.createElement(DataTable.Cell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 29\n      }\n    }, student.id), React.createElement(DataTable.Cell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 29\n      }\n    }, student.fname, \" \", student.lname), React.createElement(DataTable.Cell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 29\n      }\n    }, student.classroom_name, \" \", student.section_name), React.createElement(DataTable.Cell, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 29\n      }\n    }, \"Heyyyyyyy\"));\n  }))));\n}","map":{"version":3,"sources":["/opt/lampp/htdocs/codi/LMS/lms_native/Take_Attendance.js"],"names":["React","useState","useEffect","DataTable","API","Classroom","Section","Take_Attendance","students","classroom_id","section_id","attendance","showSubmit","state","updateState","today","Date","year","getFullYear","month","getMonth","day","getDate","date","filter","fetchdata","setState","post","then","res","result","data","s","map","id","get","update","a","created_at","slice","length","student_id","description","checkSubmit","nextState","prevState","handleChange","e","target","name","value","changeDescription","key","val","submitAttendance","updateFunction","i","student","reqBody","att","find","put","createFunction","JSON","stringify","alert","backgroundColor","fontSize","color","display","fname","lname","classroom_name","section_name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Text, View } from 'react-native';\nimport { DataTable } from 'react-native-paper';\nimport API from './api';\n\n\nimport Classroom from './components/Classroom';\nimport Section from './components/Section';\n\nexport default function Take_Attendance() {\n\n    const [state, updateState] = useState({\n        students: [],\n        classroom_id: \"\",\n        section_id: \"\",\n        attendance: {},\n        showSubmit: false,\n    });\n\n    var today = new Date();\n    var year = today.getFullYear();\n    var month = (today.getMonth() + 1);\n    var day = today.getDate();\n\n    if (month < 10) month = \"0\" + month;\n    if (day < 10) day = \"0\" + day;\n\n    var date = year + '-' + month + '-' + day;\n\n    const filter = {\n        section_id: state.section_id,\n        classroom_id: state.classroom_id,\n    };\n\n    const fetchdata = async () => {\n\n        setState({ attendance: {} });\n\n        await API.post(`stu-sec-class`)\n            .then(res => {\n                const result = res.data.data;\n                const data = result.filter(s => s.section_id == state.section_id);\n                if (data) {\n                    data.map(s => {\n                        const attendance = state.attendance;\n                        attendance[s.id] = \"Present\";\n                        setState({ attendance: attendance });\n                    });\n                }\n                setState({ students: data });\n            });\n\n        await API.get(`attendance`)\n            .then(res => {\n                const result = res.data.data;\n                const update = result.filter(a =>\n                    (a.created_at.slice(0, 10) == date && a.section_id == state.section_id)\n                );\n                if (update && update.length) {\n                    update.map(s => {\n                        const attendance = state.attendance;\n                        attendance[s.student_id] = s.description;\n                        setState({ attendance: attendance });\n                    });\n                }\n            });\n\n        if (state.classroom_id == \"\") setState({ section_id: \"\" });\n        checkSubmit();\n    }\n\n    const checkSubmit = () => {\n        (state.section_id != \"\") ? setState({ showSubmit: true }) : setState({ showSubmit: false });\n    }\n\n    const setState = (nextState) => {\n        updateState(prevState => ({\n            ...prevState,\n            ...nextState\n        }));\n    }\n\n    const handleChange = e => {\n        let { name, value } = e.target;\n        setState({ [name]: value });\n    }\n\n    const changeDescription = (key, val) => {\n        const attendance = state.attendance;\n        attendance[key] = val;\n        setState({ attendance: attendance });\n    }\n\n    const submitAttendance = async () => {\n\n        const updateFunction = async (update) => {\n            for (let i = 0; i < state.students.length; i++) {\n                let student = state.students[i];\n                let key = student.id;\n                let reqBody = {\n                    description: state.attendance[key],\n                    section_id: state.section_id,\n                    student_id: key\n                }\n                let att = update.find(a => a.student_id == key);\n                let id = att.id;\n\n                await API.put(`attendance/${id}`, reqBody);\n            }\n        }\n\n        const createFunction = async () => {\n            state.students.map(async (student) => {\n                let key = student.id;\n                let reqBody = {\n                    description: state.attendance[key],\n                    section_id: state.section_id,\n                    student_id: key\n                }\n                await API.post(`attendance`, reqBody);\n            });\n        }\n\n        await API.get(`attendance`)\n            .then(res => {\n                const result = res.data.data;\n                const update = result.filter(a =>\n                    (a.created_at.slice(0, 10) == date && a.section_id == state.section_id)\n                );\n                if (update && update.length) {\n                    updateFunction(update);\n                } else {\n                    createFunction();\n                }\n            });\n    }\n\n    useEffect(() => {\n        fetchdata();\n    }, [JSON.stringify(filter)]);\n\n\n    return (\n        <View>\n\n            <Text></Text>\n            <Text></Text>\n\n            <View>\n                <View className=\"helloclass\">\n                    <Classroom\n                        id={state.classroom_id}\n                        name=\"classroom_id\"\n                        onValueChange={handleChange}\n                    />\n                    <Section\n                        id={state.classroom_id}\n                        onValueChange={handleChange}\n                        selectedValue={state.section_id}\n                    />\n                </View>\n\n                <TouchableOpacity\n        onPress={() => alert('Hello, world!')}\n        style={{ backgroundColor: 'blue' }}>\n        <Text style={{ fontSize: 20, color: '#fff' }}>Pick a photo</Text>\n      </TouchableOpacity>\n                <input\n                    type=\"button\"\n                    value=\"Submit\"\n                    onClick={submitAttendance}\n                    style={{ display: state.showSubmit ? 'block' : 'none' }}\n                    className=\"filterClass absolutsubmitbutton\"\n                />\n            </View>\n\n            <View>\n                <DataTable>\n                    <DataTable.Header>\n                        <DataTable.Title>ID</DataTable.Title>\n                        <DataTable.Title>Name</DataTable.Title>\n                        <DataTable.Title>Class</DataTable.Title>\n                        <DataTable.Title>Attendance</DataTable.Title>\n                    </DataTable.Header>\n\n                    {state.students.map(student => (\n                        <DataTable.Row>\n                            <DataTable.Cell>{student.id}</DataTable.Cell>\n                            <DataTable.Cell>{student.fname} {student.lname}</DataTable.Cell>\n                            <DataTable.Cell>{student.classroom_name} {student.section_name}</DataTable.Cell>\n                            <DataTable.Cell>Heyyyyyyy</DataTable.Cell>\n                        </DataTable.Row>\n                    ))}\n                </DataTable>\n            </View>\n        </View>\n    );\n}"]},"metadata":{},"sourceType":"module"}